

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>模板 &mdash; Explore Flask 1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Explore Flask 1.0 documentation" href="index.html"/>
        <link rel="next" title="静态文件" href="static.html"/>
        <link rel="prev" title="蓝图" href="blueprints.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Explore Flask</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="preface.html">前言</a><ul>
<li class="toctree-l2"><a class="reference internal" href="preface.html#id2">假设</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#id8">动态文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#id9">本书使用的约定</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#id13">彩蛋</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#id14">摘要</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="conventions.html">编码约定</a><ul>
<li class="toctree-l2"><a class="reference internal" href="conventions.html#pep">让我们来个 PEP 动员！</a></li>
<li class="toctree-l2"><a class="reference internal" href="conventions.html#id3">相对导入</a></li>
<li class="toctree-l2"><a class="reference internal" href="conventions.html#id4">摘要</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="environment.html">环境</a><ul>
<li class="toctree-l2"><a class="reference internal" href="environment.html#virtualenv">使用 virtualenv 管理你的环境</a></li>
<li class="toctree-l2"><a class="reference internal" href="environment.html#id6">版本控制</a></li>
<li class="toctree-l2"><a class="reference internal" href="environment.html#id8">调试</a></li>
<li class="toctree-l2"><a class="reference internal" href="environment.html#id12">摘要</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="organizing.html">组织你的项目</a><ul>
<li class="toctree-l2"><a class="reference internal" href="organizing.html#id2">定义</a></li>
<li class="toctree-l2"><a class="reference internal" href="organizing.html#id4">组织模式</a></li>
<li class="toctree-l2"><a class="reference internal" href="organizing.html#id10">摘要</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">配置</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#id2">简单的例子</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#id3">实例文件夹</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#id8">基于环境变量配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#id9">摘要</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="views.html">视图和路由的高级模式</a><ul>
<li class="toctree-l2"><a class="reference internal" href="views.html#id2">视图装饰器</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#url-converters">URL 转换器(converters)</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#id9">摘要</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="blueprints.html">蓝图</a><ul>
<li class="toctree-l2"><a class="reference internal" href="blueprints.html#id2">什么是蓝图？</a></li>
<li class="toctree-l2"><a class="reference internal" href="blueprints.html#id3">为什么要使用蓝图？</a></li>
<li class="toctree-l2"><a class="reference internal" href="blueprints.html#id5">你把它们放哪里？</a></li>
<li class="toctree-l2"><a class="reference internal" href="blueprints.html#id9">你如何使用它们？</a></li>
<li class="toctree-l2"><a class="reference internal" href="blueprints.html#id12">使用蓝图重构小的应用程序</a></li>
<li class="toctree-l2"><a class="reference internal" href="blueprints.html#id18">摘要</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">模板</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#jinja">Jinja 快速入门</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">如何组织模板</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id4">继承</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id6">创建宏</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id9">自定义过滤器</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id11">摘要</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="static.html">静态文件</a><ul>
<li class="toctree-l2"><a class="reference internal" href="static.html#id2">组织你的静态文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="static.html#flask-assets">使用 Flask-Assets 管理静态资源</a></li>
<li class="toctree-l2"><a class="reference internal" href="static.html#id7">摘要</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="storing.html">存储数据</a><ul>
<li class="toctree-l2"><a class="reference internal" href="storing.html#sqlalchemy">SQLAlchemy</a></li>
<li class="toctree-l2"><a class="reference internal" href="storing.html#id5">摘要</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="forms.html">处理表单</a><ul>
<li class="toctree-l2"><a class="reference internal" href="forms.html#flask-wtf">Flask-WTF</a></li>
<li class="toctree-l2"><a class="reference internal" href="forms.html#id9">摘要</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="users.html">处理用户的模式</a><ul>
<li class="toctree-l2"><a class="reference internal" href="users.html#id2">确认电子邮箱</a></li>
<li class="toctree-l2"><a class="reference internal" href="users.html#id3">存储密码</a></li>
<li class="toctree-l2"><a class="reference internal" href="users.html#id5">认证</a></li>
<li class="toctree-l2"><a class="reference internal" href="users.html#id7">忘记密码</a></li>
<li class="toctree-l2"><a class="reference internal" href="users.html#id8">摘要</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">部署</a><ul>
<li class="toctree-l2"><a class="reference internal" href="deployment.html#id2">主机</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment.html#id3">部署方式</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment.html#id7">摘要</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="conclusion.html">结尾</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Explore Flask</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>模板</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/templates.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="id1">
<h1>模板<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<img alt="Templates" src="_images/templates.png" />
<p>虽然 Flask 并不强迫我们使用任何一个特定的模板语言，它假设我们要使用 Jinja。在 Flask 社区中大部分开发者使用 Jinja，我建议你们也这样做。有很多的扩展帮助我们使用其它的模板语言，像 <a class="reference external" href="http://pythonhosted.org/Flask-Genshi/">Flask-Genshi</a> 和 <a class="reference external" href="http://pythonhosted.org/Flask-Mako/">Flask-Mako</a>。坚持使用默认的模板语言，除非你有更好的理由使用其它的模板语言。还不知道 Jinja 语法不是一个好的理由！你会节省大量的时间和烦恼。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">当我们提及到 &#8220;Jinja.&#8221; 的时候，就是在说 Jinja2。存在 Jinja1，但是我们不会与它打交道。我们讨论的是这个：<a class="reference external" href="http://jinja.pocoo.org/">http://jinja.pocoo.org/</a>。</p>
</div>
<div class="section" id="jinja">
<h2>Jinja 快速入门<a class="headerlink" href="#jinja" title="Permalink to this headline">¶</a></h2>
<p>Jinja 官方文档在解释语法和语言的功能上做出很大的工作。我不会在这里重复，但是我要确保你卡不到这个重要的注意事项：</p>
<blockquote>
<div><p>有两种分隔符。<code class="docutils literal"><span class="pre">{%</span> <span class="pre">...</span> <span class="pre">%}</span></code> 和 <code class="docutils literal"><span class="pre">{{</span> <span class="pre">...</span> <span class="pre">}}</span></code>。第一个用于执行类似 for 循环或者赋值的声明，后者是用于输出表达的结果到模板中。</p>
<p class="attribution">&mdash;<a class="reference external" href="http://jinja.pocoo.org/docs/templates/#synopsis">Jinja 模板设计文档</a></p>
</div></blockquote>
</div>
<div class="section" id="id3">
<h2>如何组织模板<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>那么模板如何融入到我们的应用程序？如果你一直关注 Flask 的话，你可能注意到了 Flask 是十分灵活，它并没有对其内容进行一些特殊的限制。模板也不例外。你可能也注意到了通常有一个推荐的地方来放置东西（比如，模板）。对于模板而言，那个地方就是在包的目录里。</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre>myapp/
    __init__.py
    models.py
    views/
    templates/
    static/
run.py
requirements.txt
</pre></div>
</td></tr></table></div>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre>templates/
    layout.html
    index.html
    about.html
    profile/
        layout.html
        index.html
    photos.html
    admin/
        layout.html
        index.html
        analytics.html
</pre></div>
</td></tr></table></div>
<p><em>templates</em> 目录的结构是与我们路由结构平行的。对于路由 <em>myapp.com/admin/analytics</em> 的模板就是 <em>templates/admin/analytics.html</em>。在目录里面还有一些额外的模板，它们不会直接地被渲染。<em>layout.html</em> 文件是为了让其它的模板继承。</p>
</div>
<div class="section" id="id4">
<h2>继承<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>很像蝙蝠侠的背景故事一样，一个组织优秀的模板目录很大程度上依靠继承。<strong>父模板</strong> 通常定义一个通用的结构，所有 <strong>子模板</strong> 都能很好的继承它。在我们的例子中，<em>layout.html</em> 就是一个父模板而其它 <em>.html</em> 文件就是子模板。</p>
<p>你通常有一个顶层的 <em>layout.html</em>，它定义了你的应用程序的通用布局以及你的网站的每一部分。如果你看看上面的目录的话，你会看到一个顶层的 <em>myapp/templates/layout.html</em>，同样还有 <em>myapp/templates/profile/layout.html</em> 和 <em>myapp/templates/admin/layout.html</em>。最后两个文件继承和修改第一个文件。</p>
<p>继承是用 <code class="docutils literal"><span class="pre">{%</span> <span class="pre">extends</span> <span class="pre">%}</span></code> 和 <code class="docutils literal"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">%}</span></code> 标签实现的。在父模板中，我们能定义由子模板来填充的块。</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre>{# _myapp/templates/layout.html_ #}

&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
    &lt;head&gt;
        &lt;title&gt;{% block title %}{% endblock %}&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
    {% block body %}
        &lt;h1&gt;This heading is defined in the parent.&lt;/h1&gt;
    {% endblock %}
    &lt;/body&gt;
&lt;/html&gt;
</pre></div>
</td></tr></table></div>
<p>在子模板中，我们可以扩展父模板并且定义这些块的内容。</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre>{# _myapp/templates/index.html_ #}

{% extends &quot;layout.html&quot; %}
{% block title %}Hello world!{% endblock %}
{% block body %}
    {{ super() }}
    &lt;h2&gt;This heading is defined in the child.&lt;/h2&gt;
{% endblock %}
</pre></div>
</td></tr></table></div>
<p><code class="docutils literal"><span class="pre">super()</span></code> 函数让我们渲染父级块的内容。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">关于继承的更多信息，请参阅 <a class="reference external" href="http://jinja.pocoo.org/docs/templates/#template-inheritance">Jinja 模板继承文档</a>。</p>
</div>
</div>
<div class="section" id="id6">
<h2>创建宏<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>我们可以在我们模板中坚持 DRY（不要重复自己）的原则，通过抽象出重复出现的代码片段到 <strong>宏</strong>。如果我们正工作在为我们应用程序导航的 HTML 上，我们需要给一个 “活跃的”链接一个 class（class=&#8221;active&#8221;）。没有宏的话，我们要编写一大段 <code class="docutils literal"><span class="pre">if</span> <span class="pre">...</span> <span class="pre">else</span></code> 语句，这些语句检查每一个链接找到正处于活跃的一个。</p>
<p>宏提供了一种模块化代码的方式；它们像函数一样工作。让我们看看如何使用宏标记一个活跃的链接。</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre>{# myapp/templates/layout.html #}

{% from &quot;macros.html&quot; import nav_link with context %}
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
    &lt;head&gt;
    {% block head %}
        &lt;title&gt;My application&lt;/title&gt;
    {% endblock %}
    &lt;/head&gt;
    &lt;body&gt;
        &lt;ul class=&quot;nav-list&quot;&gt;
            {{ nav_link(&#39;home&#39;, &#39;Home&#39;) }}
            {{ nav_link(&#39;about&#39;, &#39;About&#39;) }}
            {{ nav_link(&#39;contact&#39;, &#39;Get in touch&#39;) }}
        &lt;/ul&gt;
    {% block body %}
    {% endblock %}
    &lt;/body&gt;
&lt;/html&gt;
</pre></div>
</td></tr></table></div>
<p>在这个模板中我们现在要做的就是调用一个未定义的宏 - <code class="docutils literal"><span class="pre">nav_link</span></code> -接着向其传递两个参数：目标端点（例如，目标视图的函数名）以及我们要显示的文本。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>你可能会注意到在导入语句中我们指定了 <code class="docutils literal"><span class="pre">with</span> <span class="pre">context</span></code>。Jinja 的 <strong>context</strong> 是由传递到 <code class="docutils literal"><span class="pre">render_template()</span></code> 函数的参数以及来自我们的 Python 代码的 Jinja 环境上下文组成。对于模板来说，这些变量在模板被渲染的时候是可用的。</p>
<p class="last">一些变量是明显地有我们传入，例如，<code class="docutils literal"><span class="pre">render_template(&quot;index.html&quot;,</span> <span class="pre">color=&quot;red&quot;)</span></code>，但是还有一些变量和函数是由 Flask 自动地包含在上下文中，例如，<code class="docutils literal"><span class="pre">request</span></code>, <code class="docutils literal"><span class="pre">g</span></code> 和 <code class="docutils literal"><span class="pre">session</span></code>。当我们说 <code class="docutils literal"><span class="pre">{%</span> <span class="pre">from</span> <span class="pre">...</span> <span class="pre">import</span> <span class="pre">...</span> <span class="pre">with</span> <span class="pre">context</span> <span class="pre">%}</span></code> 的时候，就是告诉 Jinja 是由的这些变量对宏也可用。</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>通过 Flask 传入到 Jinja 上下文的所有全局变量：
<a class="reference external" href="http://flask.pocoo.org/docs/templating/#standard">http://flask.pocoo.org/docs/templating/#standard</a>-context（中文翻译：<a class="reference external" href="http://www.pythondoc.com/flask/templating.html#id2">http://www.pythondoc.com/flask/templating.html#id2</a>）。</li>
<li>我们可以使用上下文处理器定义我们想要并入 Jinja 上下文的变量和函数:
<a class="reference external" href="http://flask.pocoo.org/docs/templating/#context">http://flask.pocoo.org/docs/templating/#context</a>-processors（中文翻译：<a class="reference external" href="http://www.pythondoc.com/flask/templating.html#id6">http://www.pythondoc.com/flask/templating.html#id6</a>）。</li>
</ul>
</div>
<p>现在是时候定义在我们模板中使用的 <code class="docutils literal"><span class="pre">nav_link</span></code> 宏。</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre>{# myapp/templates/macros.html #}

{% macro nav_link(endpoint, text) %}
{% if request.endpoint.endswith(endpoint) %}
    &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;{{ url_for(endpoint) }}&quot;&gt;{{text}}&lt;/a&gt;&lt;/li&gt;
{% else %}
    &lt;li&gt;&lt;a href=&quot;{{ url_for(endpoint) }}&quot;&gt;{{text}}&lt;/a&gt;&lt;/li&gt;
{% endif %}
{% endmacro %}
</pre></div>
</td></tr></table></div>
<p>现在我们已经在 <em>myapp/templates/macros.html</em> 中定义了宏。在这个宏中我们使用了 Flask 的 <code class="docutils literal"><span class="pre">request</span></code> 对象 — 默认情况下在 Jinja 上下文中是可用的 — 用来检查传入到 <code class="docutils literal"><span class="pre">nav_link</span></code> 中的路由的端点是否是当前请求。如果是，我们正在当前页面上，接着我们标记它为活跃的。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">从 x 导入 y 语句采用了 x 的相对路径。如果我们的模板是 <em>myapp/templates/user/blog.html</em>，我们可以在使用 <a href="#id7"><span class="problematic" id="id8">``</span></a>from &#8221;../macros.html&#8221; 导入 nav_link。</p>
</div>
</div>
<div class="section" id="id9">
<h2>自定义过滤器<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>Jinja 过滤器是一个函数，它能够在 <code class="docutils literal"><span class="pre">{{</span> <span class="pre">...</span> <span class="pre">}}</span></code> 中用于处理一个表达式的结果。在表达式结果输出到模板之前它就被调用。</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre>&lt;h2&gt;{{ article.title|title }}&lt;/h2&gt;
</pre></div>
</td></tr></table></div>
<p>在这段代码中，<code class="docutils literal"><span class="pre">title</span></code> 过滤器接受 <code class="docutils literal"><span class="pre">article.title</span></code> 作为参数并且返回一个过滤后的标题，接着过滤后的标题将会输出到模板中。这就像 UNIX 的“管道化”一个程序到另一个程序的输出。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">有很多像 <code class="docutils literal"><span class="pre">title</span></code> 一样的内置过滤器。请参阅 Jinja 文档中的 <a class="reference external" href="http://jinja.pocoo.org/docs/templates/#builtin-filters">完整列表</a>。</p>
</div>
<p>我们可以在我们的 Jinja 模板中定义自己的过滤器供使用。举例来说，我们将会实现一个简单 <code class="docutils literal"><span class="pre">caps</span></code> 过滤器用来大写一个字符串中所有的字母。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Jinja 已经有一个 <code class="docutils literal"><span class="pre">upper</span></code> 过滤器来做这样的事情，并且还有一个 <code class="docutils literal"><span class="pre">capitalize</span></code> 过滤器，它能用来大写第一个字母，小写其余的字母。这些也能处理 unicode 转换，但是我们会继续我们的示例，让大家目前能够知道如何自定义过滤器。</p>
</div>
<p>我们要在 <em>myapp/util/filters.py</em> 中定义我们的过滤器。这里给出一个 <code class="docutils literal"><span class="pre">util</span></code> 包，它里面有各种各样的模块。</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># myapp/util/filters.py</span>

<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">app</span>

<span class="nd">@app.template_filter</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">caps</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a string to all caps.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">uppercase</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>在这段代码中我们使用 <code class="docutils literal"><span class="pre">&#64;app.template_filter()</span></code> 装饰器注册我们的函数成一个 Jinja 过滤器。默认的过滤器名称就是函数的名称，但是你可以传入一个参数到装饰器中来改变它。</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="nd">@app.template_filter</span><span class="p">(</span><span class="s">&#39;make_caps&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">caps</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a string to all caps.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">uppercase</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>现在我们可以在模板中调用 <code class="docutils literal"><span class="pre">make_caps</span></code> 而不是 <code class="docutils literal"><span class="pre">caps</span></code>：<code class="docutils literal"><span class="pre">{{</span> <span class="pre">&quot;hello</span> <span class="pre">world!&quot;|make_caps</span> <span class="pre">}}</span></code>。</p>
<p>为了要使用让我们的过滤器在模板中可用的话，我只需要在我们的顶层 <em>__init.py__</em> 的中导入它。</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># myapp/__init__.py</span>

<span class="c"># Make sure app has been initialized first to prevent circular imports.</span>
<span class="kn">from</span> <span class="nn">.util</span> <span class="kn">import</span> <span class="n">filters</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id11">
<h2>摘要<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>使用 Jinja 模板。</li>
<li>Jinja 有两种分隔符。<code class="docutils literal"><span class="pre">{%</span> <span class="pre">...</span> <span class="pre">%}</span></code> 和 <code class="docutils literal"><span class="pre">{{</span> <span class="pre">...</span> <span class="pre">}}</span></code>。
第一个用于执行类似 for 循环或者赋值的声明，后者是用于输出表达的结果到模板中。</li>
<li>模板应该在 <em>myapp/templates/</em> 中 — 例如，在应用程序包中的一个目录。</li>
<li>我建议模板/目录结构反映应用程序的 URL 结构。</li>
<li>你应该在 <em>myapp/templates</em> 中有一个顶层的 <em>layout.html</em>，同样网站的每一部分也应该有一个。后者继承并且扩展了前者。</li>
<li>宏就像由模板代码构成的函数。</li>
<li>过滤器就是有 Python 代码组成的函数并且能在模板中使用。</li>
</ul>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="static.html" class="btn btn-neutral float-right" title="静态文件"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="blueprints.html" class="btn btn-neutral" title="蓝图"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Robert Picard.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50579609-1', 'exploreflask.com');
  ga('send', 'pageview');

</script>


</body>
</html>